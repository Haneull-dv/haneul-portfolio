# ğŸ—„ï¸ DB ì ‘ì† ëª…ë ¹ì–´ë“¤
# Railway DB ì ‘ì†
$env:PGPASSWORD = "eOsxxfAyduDCmCLfzwhWioXppxufVcLY"
psql -h crossover.proxy.rlwy.net -U postgres -p 47251 -d railway

# PostgreSQL ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it db bash

# DB ì ‘ì†
psql -U hc_user -d hc_db

# ì»¬ëŸ¼ í™•ì¸
\d dsd_source

# ğŸ³ ìƒˆë¡œ ì¶”ê°€ëœ ì„œë¹„ìŠ¤ë“¤

## StockPrice ì„œë¹„ìŠ¤ (í¬íŠ¸: 9006)
# ë¹Œë“œ ë° ì‹¤í–‰
docker-compose up -d --build stockprice

# ğŸ”¥ ê°œë°œ ëª¨ë“œ (Live Reload) - ë¹Œë“œ ì—†ì´ ì½”ë“œ ì¦‰ì‹œ ë°˜ì˜
docker-compose stop stockprice
docker-compose up -d stockprice
# ë˜ëŠ” make dev-stockprice

# ë¡œê·¸ í™•ì¸
docker-compose logs -f stockprice

# ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it stockprice bash

# API í…ŒìŠ¤íŠ¸
curl http://localhost:9006/api/v1/stockprice/?symbol=005930
curl http://localhost:9006/api/v1/stockprice/trend?symbol=005930&period=1y
curl http://localhost:9006/api/v1/stockprice/analysis?symbol=005930

# ê°œë°œ ì¤‘ ìœ ìš©í•œ ëª…ë ¹ì–´ë“¤
# ì‹¤ì‹œê°„ ë¡œê·¸ + API í…ŒìŠ¤íŠ¸
docker-compose logs -f stockprice &
curl http://localhost:9006/docs

## N8N ì›Œí¬í”Œë¡œìš° ìë™í™” (í¬íŠ¸: 5678)
# ì ‘ì† ì •ë³´
# URL: http://localhost:5678
# Username: admin
# Password: password

# N8N ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it n8n sh

# N8N ë¡œê·¸ í™•ì¸
docker-compose logs -f n8n

# N8N ë°ì´í„° ë°±ì—…
docker cp n8n:/home/node/.n8n ./n8n_backup

# ğŸ”— í†µí•© ì„œë¹„ìŠ¤ ëª…ë ¹ì–´ë“¤

# ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d --build

# ì£¼ê°€ ê´€ë ¨ ì„œë¹„ìŠ¤ë§Œ ì‹œì‘
docker-compose up -d stockprice stocktrend

# ì›Œí¬í”Œë¡œìš° í™˜ê²½ ì‹œì‘ (N8N + ì£¼ê°€ ì„œë¹„ìŠ¤ë“¤)
docker-compose up -d n8n stockprice stocktrend

# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
docker-compose ps

# ëª¨ë“  ë¡œê·¸ í™•ì¸
docker-compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ ì¬ì‹œì‘
docker-compose restart stockprice
docker-compose restart n8n

# ğŸ§¹ ì •ë¦¬ ëª…ë ¹ì–´ë“¤
# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€, ì»¨í…Œì´ë„ˆ ì •ë¦¬
docker system prune -f

# ëª¨ë“  ì´ë¯¸ì§€, ë³¼ë¥¨ê¹Œì§€ ì •ë¦¬ (ì£¼ì˜!)
docker system prune -a -f

# ë³¼ë¥¨ ì •ë¦¬
docker volume prune -f

#PostgreSQL ì»¨í…Œì´ë„ˆ ë‚´ë¶€ë¡œ ë“¤ì–´ê°€ê¸°
docker exec -it db bash

#PostgreSQL í„°ë¯¸ë„(psql) ì ‘ì†
psql -U haneul -d weekly_db

#í…Œì´ë¸” ëª©ë¡ ë³´ê¸°
\dt

#íŠ¹ì • í…Œì´ë¸” ë°ì´í„° ë³´ê¸°
SELECT * FROM weekly_stock_prices LIMIT 10;

#í…Œì´ë¸” ì»¬ëŸ¼(ìŠ¤í‚¤ë§ˆ) êµ¬ì¡° í™•ì¸
\d weekly_stock_prices


#ë‚˜ê°€ê¸°
#PostgreSQL ë¹ ì ¸ë‚˜ì˜¤ê¸°
\q
#ì»¨í…Œì´ë„ˆ ë¹ ì ¸ë‚˜ì˜¤ê¸°
exit
q


-- ì˜¤ëŠ˜ ì €ì¥ëœ ë°ì´í„°ë¥¼ ì‹œê°„ ìˆœì„œëŒ€ë¡œ ëª¨ë‘ í™•ì¸
SELECT COUNT(*), MIN(created_at), MAX(created_at)
FROM weekly_stock_prices 
WHERE DATE(created_at) = '2025-06-30';

-- ê°€ì¥ ìµœê·¼ 10ê°œ ë°ì´í„°ì˜ ì •í™•í•œ ì‹œê°„ í™•ì¸
SELECT id, symbol, created_at
FROM weekly_stock_prices 
WHERE DATE(created_at) = '2025-06-30'
ORDER BY created_at DESC 
LIMIT 10;

-- ì‹œê°„ëŒ€ë³„ ì €ì¥ ê±´ìˆ˜ í™•ì¸
SELECT 
    EXTRACT(HOUR FROM created_at) as hour,
    COUNT(*) as count
FROM weekly_stock_prices 
WHERE DATE(created_at) = '2025-06-30'
GROUP BY EXTRACT(HOUR FROM created_at)
ORDER BY hour;

-- í˜„ì¬ ì‹œê°„ëŒ€ ì„¤ì • í™•ì¸
SHOW timezone;

-- UTCì™€ í•œêµ­ì‹œê°„ ë¹„êµ
SELECT 
    NOW() as utc_time,
    NOW() AT TIME ZONE 'Asia/Seoul' as korea_time;

-- í•œêµ­ ì‹œê°„ìœ¼ë¡œ í™•ì¸
SELECT COUNT(*), MAX(created_at AT TIME ZONE 'Asia/Seoul') as korea_time
FROM weekly_stock_prices 
WHERE DATE(created_at AT TIME ZONE 'Asia/Seoul') = '2025-06-30';

-- ìµœì‹  10ê°œ ë°ì´í„° (ì‹œê°„ ìˆœì„œëŒ€ë¡œ)
SELECT * FROM weekly_data 
ORDER BY created_at DESC 
LIMIT 10;

-- ì˜¤ëŠ˜ ì €ì¥ëœ ìµœì‹  ë°ì´í„°ë§Œ
SELECT * FROM weekly_stock_prices 
WHERE DATE(created_at) = CURRENT_DATE
ORDER BY created_at DESC 
LIMIT 10;

-- í•œêµ­ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ ë°ì´í„°
SELECT
    stock_code,
    company_name,
    created_at,
    created_at AT TIME ZONE 'Asia/Seoul' AS created_at_kst
FROM
    disclosures
ORDER BY
    created_at DESC
LIMIT 10;

#ë³¸ê²© ë°°í¬ ì‹œì‘! ë°°í¬/ ìš´ì˜ ëª…ë ¹ì–´
[stockprice]
$env:ENV="development"
docker compose up -d --build stockprice